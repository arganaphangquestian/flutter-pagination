import 'dart:convert';

import 'package:dio/dio.dart';
import 'package:rest/history.dart';

const URL = "https://dev-e-wallet-apipg.qoin.id/transactionpg/history";
const MAX_PAGE = 40;

Future<List<History>> getHistoryPage(int page) async {
  try {
    var response =
        await Dio().get("$URL?skip=${page * MAX_PAGE}&take=$MAX_PAGE",
            options: Options(headers: {
              "Authorization":
                  "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJDbGllbnRJZCI6MSwiRXhwaXJlZCI6IjIwMjItMDctMDEgMTY6MjU6MDciLCJNZW1iZXJJZCI6MjAyLCJQZXJtaXNzaW9uIjpbIkFwcDpQcm9maWxlOkdldCIsIkFwcDpQcm9maWxlOkVkaXQiLCJBcHA6UHJvZmlsZTpEZWxldGUiLCJBcHA6TWVkaWE6RWRpdCIsIkFwcDpQYXNzd29yZDpDcmVhdGUiLCJBcHA6UGFzc3dvcmQ6RWRpdCIsIkFwcDpQSU46RWRpdCIsIkFwcDpQSU46Rm9yZ290IiwiQXBwOkRvY3VtZW50czpHZXQiLCJBcHA6RG9jdW1lbnQ6R2V0IiwiQXBwOkRvY3VtZW50OkNyZWF0ZSIsIkFwcDpEb2N1bWVudDpVcGRhdGUiLCJBcHA6RG9jdW1lbnQ6RGVsZXRlIiwiQXBwOkRvY3VtZW50TG9zdHM6R2V0IiwiQXBwOkRvY3VtZW50TG9zdDpHZXQiLCJBcHA6RG9jdW1lbnRMb3N0OkNyZWF0ZSIsIkFwcDpEb2N1bWVudExvc3Q6VXBkYXRlIiwiQXBwOkRvY3VtZW50TG9zdDpEZWxldGUiLCJBcHA6VXNlcjpVcGdyYWRlIiwiQXBwOk1lbWJlcjpHZXQiLCJBcHA6TWVtYmVyOkNyZWF0ZSIsIkFwcDpNZW1iZXI6RWRpdCIsIkFwcDpNZW1iZXI6RGVsZXRlIiwiQXBwOk1lbWJlckxldmVsOkdldCIsIkFwcDpNZW1iZXJMZXZlbDpDcmVhdGUiLCJBcHA6TWVtYmVyTGV2ZWw6RWRpdCIsIkFwcDpNZW1iZXJMZXZlbDpEZWxldGUiLCJBcHA6TWVtYmVySWQ6R2V0IiwiQXBwOk1lbWJlcklkOkNyZWF0ZSIsIkFwcDpNZW1iZXJJZDpFZGl0IiwiQXBwOk1lbWJlcklkOkRlbGV0ZSIsIkFwcDpNZW1iZXJHcm91cDpHZXQiLCJBcHA6TWVtYmVyR3JvdXA6Q3JlYXRlIiwiQXBwOk1lbWJlckdyb3VwOkVkaXQiLCJBcHA6TWVtYmVyR3JvdXA6RGVsZXRlIiwiQXBwOk1lbWJlckNhcmRUeXBlOkdldCIsIkFwcDpNZW1iZXJDYXJkVHlwZTpDcmVhdGUiLCJBcHA6TWVtYmVyQ2FyZFR5cGU6RWRpdCIsIkFwcDpNZW1iZXJDYXJkVHlwZTpEZWxldGUiLCJBcHA6TWVtYmVyQXR0cjpHZXQiLCJBcHA6TWVtYmVyQXR0cjpDcmVhdGUiLCJBcHA6TWVtYmVyQXR0cjpFZGl0IiwiQXBwOk1lbWJlckF0dHI6RGVsZXRlIiwiQXBwOk1lbWJlckFkZHJlc3M6R2V0IiwiQXBwOk1lbWJlckFkZHJlc3M6Q3JlYXRlIiwiQXBwOk1lbWJlckFkZHJlc3M6RWRpdCIsIkFwcDpNZW1iZXJBZGRyZXNzOkRlbGV0ZSIsIkFwcDpNZW1iZXJBY3RpdmU6R2V0IiwiQXBwOk1lbWJlckFjdGl2ZTpDcmVhdGUiLCJBcHA6TWVtYmVyQWN0aXZlOkVkaXQiLCJBcHA6TWVtYmVyQWN0aXZlOkRlbGV0ZSIsIkFwcDpNZW1iZXJQcm9maWxlOkdldCIsIkFwcDpNZW1iZXJQcm9maWxlOkNyZWF0ZSIsIkFwcDpNZW1iZXJQcm9maWxlOkVkaXQiLCJBcHA6TWVtYmVyUHJvZmlsZTpEZWxldGUiLCJBcHA6UmVmZXJyYWxJc3N1ZXI6R2V0IiwiQXBwOlJlZmVycmFsSXNzdWVyOkNyZWF0ZSIsIkFwcDpSZWZlcnJhbElzc3VlcjpFZGl0IiwiQXBwOlJlZmVycmFsSXNzdWVyOkRlbGV0ZSIsIkFwcDpSZWZlcnJhbERpc3RyaWJ1dGU6R2V0IiwiQXBwOlJlZmVycmFsRGlzdHJpYnV0ZTpDcmVhdGUiLCJBcHA6UmVmZXJyYWxEaXN0cmlidXRlOkVkaXQiLCJBcHA6UmVmZXJyYWxEaXN0cmlidXRlOkRlbGV0ZSIsIkFwcDpSZWZlcnJhbE1hc3RlcjpHZXQiLCJBcHA6UmVmZXJyYWxNYXN0ZXI6Q3JlYXRlIiwiQXBwOlJlZmVycmFsTWFzdGVyOkVkaXQiLCJBcHA6UmVmZXJyYWxNYXN0ZXI6RGVsZXRlIiwiQXBwOlJlZmVycmFsU2VudDpHZXQiLCJBcHA6UmVmZXJyYWxTZW50OkNyZWF0ZSIsIkFwcDpSZWZlcnJhbFNlbnQ6RWRpdCIsIkFwcDpSZWZlcnJhbFNlbnQ6RGVsZXRlIiwiQXBwOlRyYW5zYWN0aW9uOkdldCIsIkFwcDpUcmFuc2FjdGlvbjpDcmVhdGUiLCJBcHA6TWVyY2hhbnQ6R2V0IiwiQXBwOk1lcmNoYW50OkNyZWF0ZSIsIkFwcDpNZXJjaGFudDpFZGl0IiwiQXBwOk1lcmNoYW50OkRlbGV0ZSIsIkFwcDpNZXJjaGFudEFjdGl2ZTpHZXQiLCJBcHA6TWVyY2hhbnRBY3RpdmU6Q3JlYXRlIiwiQXBwOk1lcmNoYW50QWN0aXZlOkVkaXQiLCJBcHA6TWVyY2hhbnRBY3RpdmU6RGVsZXRlIiwiQXBwOk1lcmNoYW50QWRkcmVzczpHZXQiLCJBcHA6TWVyY2hhbnRBZGRyZXNzOkNyZWF0ZSIsIkFwcDpNZXJjaGFudEFkZHJlc3M6RWRpdCIsIkFwcDpNZXJjaGFudEFkZHJlc3M6RGVsZXRlIiwiQXBwOk1lcmNoYW50TGV2ZWw6R2V0IiwiQXBwOk1lcmNoYW50TGV2ZWw6Q3JlYXRlIiwiQXBwOk1lcmNoYW50TGV2ZWw6RWRpdCIsIkFwcDpNZXJjaGFudExldmVsOkRlbGV0ZSIsIkFwcDpNZXJjaGFudElkOkdldCIsIkFwcDpNZXJjaGFudElkOkNyZWF0ZSIsIkFwcDpNZXJjaGFudElkOkVkaXQiLCJBcHA6TWVyY2hhbnRJZDpEZWxldGUiLCJBcHA6TWVyY2hhbnRBdHRyOkdldCIsIkFwcDpNZXJjaGFudEF0dHI6Q3JlYXRlIiwiQXBwOk1lcmNoYW50QXR0cjpFZGl0IiwiQXBwOk1lcmNoYW50QXR0cjpEZWxldGUiLCJBcHA6TWVyY2hhbnRQcm9kdWN0OkdldCIsIkFwcDpNZXJjaGFudFByb2R1Y3Q6Q3JlYXRlIiwiQXBwOk1lcmNoYW50UHJvZHVjdDpFZGl0IiwiQXBwOk1lcmNoYW50UHJvZHVjdDpEZWxldGUiLCJBcHA6TWVtYmVyOkZvcmdvdFBJTiIsIkFwcDpNZW1iZXI6Rm9yZ290UElOIiwiQXBwOk1lbWJlcjpGb3Jnb3RQSU4iLCJBcHA6TWVtYmVyOkZvcmdvdFBJTiIsIkFwcDpDaGVjayJdLCJTb3VyY2UiOiJhcHAiLCJVc2VySWQiOjUzNH0.UDw2-ue8BkO4KT4Srxj-dwttyPzoWf1ULP-B_b-ukJo"
            }));
    var res = <History>[];

    (response.data['data']).forEach((e) {
      res.add(History.fromJSON(e));
    });
    return res;
  } catch (e) {
    throw e;
  }
}
